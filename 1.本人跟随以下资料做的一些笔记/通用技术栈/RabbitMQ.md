## RabbitMQ（Message Queue）

### 核心思想：

接收并转发消息，可以把它想象成一个邮局。生产者并不会直接将产生的信息给于消费者，而是有一个队列来存储消息，然后消费者再从消息队列中获取消息。

### 消息队列的特性 

- 业务无关  
- FIFO
- 容灾 （可以解决一些当发生断电或各种原因导致数据传输丢失问题）
- 性能

### 为什么要用消息队列 

- 系统解耦（只需要把消息放到中间件即可，不需要反复实现数据传输的功能）
- 异步调用（比如用户只需要在平台下单，平台直接把消息放到消息队列并返回下单成功，然后后台再通过消息队列慢慢执行需要的操作，这就是所谓的异步）
- 流量削峰（高并发的时候只需要将请求放到消息队列里，然后再慢慢给服务器，这样不会导致一瞬间击穿服务器）

### RabbitMQ核心概念

![image-20230528134118615](https://s2.loli.net/2023/05/28/RsNT57AcXO9w8qY.png)

- Server：服务

- Connection：与Server建立连接

- Channel：信道，几乎所有的操作都在信道上进行，客户端可以建立多个信道

- Message：消息，由properties和body组成（存放具体的数据）

- Virtual host：虚拟主机，顶层隔离。同一个虚拟主机下，不能有重复的交换机和queue（理解为用于将不同的消息队列和交换机分组，从而区分每个独立的单元）

- Exchange：交换机，接收生产者的消息的，然后根据指定的 路由器去把消息转发到所绑定的队列上

- Binding：绑定交换机和队列选择

- Queue：队列，消费者只需要监听队列来消费，不需要关注消息来自于哪个交换机

- 交换机和消息队列存在着绑定的关系，一个 Exchage可以绑定多个消息队列

- Routing key：路由键，路由规则，（所谓路由，就是在网络中选择路径的过程），虚拟机可以用它来确定如何选择一个消息队列。

  具体表现就在，我们知道一个交换机可以绑定多个消息队列，我们只要每个消息队列对应一个路由键，即可利用路由键选择对应的消息队列，类似一个 K-V 操作。

  ![image-20230528134844864](https://s2.loli.net/2023/05/28/owpv59hzjLGFeYU.png)

  